<!--
- Nome: Pasquale
    - Cognome: Pagano
    - Matricola: 0124003182
    - Corso di Laurea: Informatica
    - Anno Accademico: 2025/2026
            &
    - Nome: Daniele
    - Cognome: Mele
    - Matricola: 0124003006
    - Corso di Laurea: Informatica
    - Anno Accademico: 2025/2026
-->

<div class="section-content cantieri-section">

    <div class="header-strip">
        <div class="header-content">
            <img src="/static/img/logo.png" class="logo-contained" alt="Logo Azienda">
            <span id="nome_azienda" class="company-name"></span>
        </div>
    </div>

    <div class="dashboard-header-card">
        <div class="dashboard-title">
            <h1>Gestione cantieri</h1>
            <p>Cantieri salvati della tua azienda</p>
        </div>

        <div class="header-actions">
            <button onclick="openAddCantiereModal()" class="add-btn">
                Aggiungi Cantiere
            </button>
        </div>
    </div>

    <div class="table-card">
        <div class="table-responsive">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Luogo</th>
                        <th>Descrizione</th>
                        <th>QR</th>
                        <th>Stato</th>
                        <th style="text-align: center;">Azione</th>
                    </tr>
                </thead>
                <tbody id="cantieri-table-body">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<div id="add-cantiere-modal" class="modal hidden">
    <div class="modal-content">
        <h3 class="modal-title">Nuovo Cantiere</h3>

        <small id="err_new_citta" class="error-msg hidden">La città è obbligatoria</small>
        <label class="form-label">Città</label>
        <input id="new_citta" class="input-field" type="text" placeholder="Es. Napoli">

        <small id="err_new_via" class="error-msg hidden">La via è obbligatoria</small>
        <label class="form-label">Via</label>
        <input id="new_via" class="input-field" type="text" placeholder="Es. Via Roma">

        <small id="err_new_civico" class="error-msg hidden">Il civico è obbligatorio</small>
        <label class="form-label">Civico</label>
        <input id="new_civico" class="input-field" type="text" placeholder="Es. 42">

        <small id="err_new_CAP" class="error-msg hidden">Il CAP è obbligatorio</small>
        <label class="form-label">CAP</label>
        <input id="new_CAP" class="input-field" type="text" placeholder="Es. 81030">

        <small id="err_new_descrizione" class="error-msg hidden">La descrizione è obbligatoria</small>
        <label class="form-label">Descrizione Lavori</label>
        <textarea id="new_descrizione" class="input-field textarea-resize-none" rows="3" placeholder="Es. Ristrutturazione facciata..."></textarea>

        <div class="modal-actions">
            <button onclick="closeAddCantiereModal()" class="cancel-btn">Annulla</button>
            <button onclick="createCantiere()" class="confirm-btn">Crea</button>
        </div>
    </div>
</div>

<div id="edit-cantiere-modal" class="modal hidden">
    <div class="modal-content">
        <h3 class="modal-title">Modifica Cantiere</h3>

        <input type="hidden" id="edit_qr_code">

        <small id="err_edit_citta" class="error-msg hidden">La città è obbligatoria</small>
        <label class="form-label">Città</label>
        <input id="edit_citta" class="input-field" type="text">

        <small id="err_edit_via" class="error-msg hidden">La via è obbligatoria</small>
        <label class="form-label">Via</label>
        <input id="edit_via" class="input-field" type="text">

        <small id="err_edit_civico" class="error-msg hidden">Il civico è obbligatorio</small>
        <label class="form-label">Civico</label>
        <input id="edit_civico" class="input-field" type="text">

        <small id="err_edit_CAP" class="error-msg hidden">Il CAP è obbligatorio</small>
        <label class="form-label">CAP</label>
        <input id="edit_CAP" class="input-field" type="text">

        <small id="err_edit_descrizione" class="error-msg hidden">La descrizione è obbligatoria</small>
        <label class="form-label">Descrizione Lavori</label>
        <textarea id="edit_descrizione" class="input-field textarea-resize-none" rows="3"></textarea>

        <small id="err_edit_capo" class="error-msg hidden">Il capo è obbligatorio</small>
        <label class="form-label">Scegli il capocantiere</label>
        <select id="edit_capo" class="input-field">
            <option value="">Scegli il capocantiere</option>
        </select>

        <small id="err_edit_stato" class="error-msg hidden">Lo stato è obbligatorio</small>
        <label class="form-label">Stato Cantiere</label>
        <select id="edit_stato" class="input-field">
            <option value="DA">Da iniziare</option>
            <option value="IN">In corso</option>
            <option value="SO">Sospeso</option>
            <option value="FI">Finito</option>
        </select>

        <div class="modal-actions">
            <button onclick="closeEditCantiereModal()" class="cancel-btn">Annulla</button>
            <button onclick="updateCantiere()" class="confirm-btn">Salva</button>
        </div>
    </div>
</div>

<div id="delete-cantiere-modal" class="modal hidden">
    <div class="modal-content">
        <h3 class="modal-title">Conferma Eliminazione</h3>
        <p class="modal-message">Sei sicuro di voler eliminare questo cantiere?</p>
        
        <div class="modal-actions">
            <button onclick="closeDeleteCantiereModal()" class="cancel-btn">Annulla</button>
            <button id="confirm-delete-cantiere-btn" class="delete-btn">Elimina</button>
        </div>
    </div>
</div>

<div id="success-modal" class="modal hidden">
    <div class="modal-content success-layout">
        <svg xmlns="http://www.w3.org/2000/svg" class="success-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg>
        <h3 class="modal-title">Operazione completata</h3>
        <p id="success-message" class="modal-message">Cantiere salvato con successo</p>
        <button onclick="closeSuccessModal()" class="confirm-btn">OK</button>
    </div>
</div>

<div id="qr-modal" class="modal hidden">
    <div class="modal-content success-layout">
        <h3 class="modal-title">Codice QR del Cantiere</h3>

        <img id="qr-modal-img" src="" alt="QR Code" class="qr-code-img">

        <div class="modal-actions">
            <button onclick="downloadQR()" class="confirm-btn download-btn">Scarica QR</button>
            <button onclick="closeQRModal()" class="cancel-btn">Chiudi</button>
        </div>
    </div>
</div>